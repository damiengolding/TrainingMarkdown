# Web application assessment just with bash (on Kali)

## Process

![Web application assessment process](bash_web_app_process.png "Web application assessment process")

## Finding web servers with curl
### Simple search with a range of hosts
    curl -w 'Success: %{remote_ip}\n' -o discovery.txt -s http://192.168.4.[20-50]
                                                        ^ silent
Output:

    Success:
    .
    .
    .
    Success: 192.168.4.32
    Success: 192.168.4.36
    Success: 192.168.4.40

### Simple search with a list of hosts
    curl -w 'Success: %{remote_ip}\n' -o discovery.txt -s http://192.168.4.{32,36,40}
Output:

    Success: 192.168.4.32
    Success: 192.168.4.36
    Success: 192.168.4.40

### Simple search with a range of hosts and range of port numbers
    curl -w 'Success: %{remote_ip}\n' -o discovery.txt -s http://192.168.4.[20-50]:[100-1024]

### Simple search with a list of hosts and list of port numbers
    curl -w '\nSuccess: %{remote_ip}1@} -w 'Port: %{remote_port}\n' -o discovery.txt -s http://192.168.4.{32,36,40}:{80,443,8080,8443,3000}
Output:

    Success: :0
    .
    .
    .
	Success: 192.168.4.32
    Success: 192.168.4.36
    Success: 192.168.4.40

## Discovering web pages
### Crawling a web application with wget
Downloads the entire site, and uses tree for sitemap comparison

    wget --recursive http://192.168.4.33/mutillidae/
    tree 192.168.4.33 > tree_01.txt

With username and hidden password

    wget --user=username --ask-password http://192.168.4.33/mutillidae/

Via proxy (don't forget to change the proxy settings in Zap from localhost to an actual interface, e.g. 192.168.1.2. The -nH (don't create host directories) is necessary when on a non-standard port, e.g. http://juice:3000 as it is not possible to create directories/files containing ':'

    wget --user=username --ask-password http://192.168.4.33/mutillidae/ -e use_proxy=yes -e http_proxy=127.0.0.1:8080 -P juice_01 -l 0 -nH

or store them in ~/.wgetrc and chmod 600

    user=<username>
    password=<password>

If UID/PWD is required in POST data, use something like the following (also saves the cookie which can be reused):

    wget --post-data='username=myemail&password=mypassword' --save-cookies cookies.txt http://192.168.4.33/mywebsite/login.php/
    wget --load-cookies cookies.txt --recursive http://192.168.4.33/mutillidae/
### Brute forcing files and folders
Simple brute force with wget

    while read word; do wget "http://<target>/&word.php"; done < /usr/share/wordlists/dirb/small.txt
Recursively with dirb

    dirb http://<target>/ /usr/share/wordlists/dirb/small.txt -o dirb.txt
### Brute forcing parameters using [ffuf](https://www.kali.org/tools/ffuf/)
Fuzz the parameter name

    ffuf -w /usr/share/wordlists/dirb/common.txt -u http://192.168.4.33/mutillidae/index.php?FUZZ=qwerty123
Output snippet:

    _vti_bin/shtml.dll  [Status: 200, Size: 45583, Words: 1710, Lines: 1103, Duration: 2546ms]
    _vti_cnf[Status: 200, Size: 45583, Words: 1710, Lines: 1103, Duration: 2503ms]
    _vti_bin/_vti_aut/author.dll [Status: 200, Size: 45583, Words: 1710, Lines: 1103, Duration: 2591ms]
    page [Status: 200, Size: 41419, Words: 1508, Lines: 979, Duration: 558ms]
    _vti_log[Status: 200, Size: 45583, Words: 1710, Lines: 1103, Duration: 2540ms]
    _vti_aut[Status: 200, Size: 45583, Words: 1710, Lines: 1103, Duration: 2602ms]
    _tmpfileop  [Status: 200, Size: 45583, Words: 1710, Lines: 1103, Duration: 2731ms]


Fuzz filtering out by response size to remove errors

    ffuf -w /usr/share/wordlists/dirb/common.txt -u http://192.168.4.33/mutillidae/index.php?FUZZ=qwerty123 -fs 45583
Output snippet:

    page[Status: 200, Size: 41419, Words: 1508, Lines: 979, Duration: 558ms]
Now filter the parameter value

    ffuf -w /usr/share/wordlists/dirb/common.txt -u http://192.168.4.33/mutillidae/index.php?page=FUZZ

Output:

    _js [Status: 200, Size: 41383, Words: 1508, Lines: 979, Duration: 2261ms]
    _includes   [Status: 200, Size: 41419, Words: 1508, Lines: 979, Duration: 2271ms]
    .git/HEAD   [Status: 200, Size: 40211, Words: 1445, Lines: 942, Duration: 8636ms]
    _inc[Status: 200, Size: 41389, Words: 1508, Lines: 979, Duration: 2273ms]
    _mem_bin[Status: 200, Size: 41413, Words: 1508, Lines: 979, Duration: 2113ms]

Fuzz filtering out by number of words to remove errors

    ffuf -w /usr/share/wordlists/dirb/common.txt -u http://192.168.4.33/mutillidae/index.php?page=FUZZ -fw 1508
Output:

    .htaccess   [Status: 200, Size: 41018, Words: 1552, Lines: 961, Duration: 7994ms]
    [Status: 200, Size: 45385, Words: 1710, Lines: 1103, Duration: 7868ms]
    .git/HEAD   [Status: 200, Size: 40211, Words: 1445, Lines: 942, Duration: 8636ms]
    admin.pl[Status: 200, Size: 38351, Words: 1302, Lines: 898, Duration: 2694ms]
    admin.php   [Status: 200, Size: 96314, Words: 4450, Lines: 1723, Duration: 3543ms]
    ajax[Status: 200, Size: 38335, Words: 1302, Lines: 898, Duration: 2573ms]

## Vulnerability discovery
### Nmap [See also](nmap.html)
Throw all the HTTP scripts at a target

    nmap -A -p 80,443 --script=http* 192.168.4.34

### [Nikto](nikto.html)
Simple really:

    nikto -h http://192.168.4.33/mutillidae

### [Wapiti](wapiti.html)