# Hashcat
[PluralSight](https://app.pluralsight.com/library/courses/credential-access-hashcat/table-of-contents)

[Web page](https://hashcat.net/hashcat/)

[pdf2john.pl & office2john.py (John the Ripper)](https://www.openwall.com/john)

> N.B. Run on non-virtualised system, i.e. not Virtual Box/VMWare etc

## Dictionary Attack
    $ hashcat -m 0 -a 0 hash.txt userpass.txt
    hashcat (v6.2.6) starting

## Dictionary Attack with a rule (leet-speak)
    $ hashcat -m 0 -a 0 hash.txt userpass.txt -r /usr/share/hashcat/rules/leetspeak.rule
    hashcat (v6.2.6) starting

## Dictionary Attack with a mask (hybrid attack)
    hashcat -m 0 -a 6 hash.txt userpass.txt ?d?d?d?d
                   ^                             ^
              attack mode 6          suffixes 4 sequentially incrementing digits (i.e. 0000 to 9999)

## Cracking a password-protected PDF
Need to know the version to set the hashcat attack mode:

    $ file password_protected.pdf
    password_protected.pdf: PDF document, version 1.7, 3 pages

Extract the hashes:

    $ /usr/share/john/pdf2john.pl password_protected.pdf
    password_protected.pdf:$pdf$*2013*100000*256*16*18fd9094ddb2e2564103197db7197fba*7e32ab96633049aa6e9a272ee2a6d91c*516164ca20cae7161a2a18a1663c6034d72073906fc571c88e636101df3780ad

PDF version is either attack mode 10600 or 10700:

    $ hashcat -m 10600 -a 0 ' $pdf$*2013*100000*256*16*18fd9094ddb2e2564103197db7197fba*7e32ab96633049aa6e9a272ee2a6d91c*516164ca20cae7161a2a18a1663c6034d72073906fc571c88e636101df3780ad ' userpass.txt


## Cracking a Password protected word DOCX
Attack mode is 9600 (DOCX was introduced in MS Office 2013)

Extract the hash:

    $ /usr/share/john/office2john.py Scratchpad/hashcat/password_protected.docx
    password_protected.docx:$office$*2013*100000*256*16*18fd9094ddb2e2564103197db7197fba*7e32ab96633049aa6e9a272ee2a6d91c*516164ca20cae7161a2a18a1663c6034d72073906fc571c88e636101df3780ad

Attack mode is 9600:

    $ hashcat -m 9600 -a 0 ' $office$*2013*100000*256*16*18fd9094ddb2e2564103197db7197fba*7e32ab96633049aa6e9a272ee2a6d91c*516164ca20cae7161a2a18a1663c6034d72073906fc571c88e636101df3780ad ' userpass.txt


