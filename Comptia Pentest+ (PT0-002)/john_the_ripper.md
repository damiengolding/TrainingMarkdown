# John the Ripper

## Windows

### Obtain sam, system and security files
    reg save HKLM\sam sam
    reg save HKLM\security security
    reg save HKLM\system system

### Obtain hashes using mimikatz
    privilege::debug
    token::elevate
    lsadump::sam /sam:sam /system:system

Copy and paste NTLM hash(es) into a text file

### Obtain hashes using Impacket
    impacket-secretsdump -sam sam -system system LOCAL > hashes.txt

### Hit it with john
    john --wordlist=passwords.txt --format=NT hashes.txt


### Single password hash 
    john --format=lm hash.txt

## Linux
### Unshadow and crack:
    unshadow /etc/passwd /etc/shadow > unshadowed.txt
    john -single --format=sha512crypt unshadowed.txt

### With custom wordlist and mangling:
    john --wordlist=passwords.txt --format=sha512crypt unshadowed.txt
    john --wordlist=passwords.txt --rules --format=sha512crypt unshadowed.txt


### Cracking for specific shells (1) and users (2)
    john --wordlist=passwords.txt --rules --shell=bash,sh unshadowed.txt --format=sha512crypt
    john --wordlist=passwords.txt --rules --users=admin,mark unshadowed.txt --format=sha512crypt

### Restart a session aborted with Ctrl-C:
    john -restore

### Show cracked passwords:
    john --show unshadowed.txt

## Other password protected files

### General approach

```
bash> locate *2john*

Then use the appropriate tool to extract the hash, and crack it:
bash> something2john my_protected.file > hash.txt
bash> john --wordlist=mywordlist.txt my_protected.file
bash> john --show my_protected.file
```

If that doesn't work, Google is your best buddy

### Password protected zip

    zip2john archive.zip > hash.txt
    john hash.txt

### Password protected rar

```
rar2john archive.rar > hash.txt
john hash.txt
```

### SSH Password protected private key file

```
N.B. ssh2john may not be installed - try 'python /opt/ssh2john.py' or 'python /usr/share/john/ssh2john.py'

ssh2john [my].id_rsa > hash.txt
john hash.txt
```

### Locations of 2john scripts

```
Kali:
ls /usr/sbin | grep 2john
ls /usr/sbin | grep 2john

Parrot:
ls /usr/share/john | 2john
```

