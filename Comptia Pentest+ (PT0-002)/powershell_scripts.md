# Powershell scripts

## Script structure
Comment:

    # To end of line
	
    <#
    Comment tag for
    multiple line
    paragraphs
    #>

## Variables
Declare:

    $VariableName=VariableValue

Access:

    Write-Host $VariableName


Typed variables:

    [int]$VariableName=123
    [string]$VariableName="Variable name"

Constants (read only):

    Set-Variable Pi -Option ReadOnly -Value 3.14159

Arrays:

    Blank array: $tempArray = @()
    Initialise with contents: $tempArray = @('Frodo','Bilbo','Gandalf')
    Access: $tempArray[n]

Named/associative arrays:

    Blank array: $PhoneBook=@{}
    Add contents: $PhoneBook.name='Gandalf'
    Initialise with contents: $PhoneBook=@{'name'='Gandalf','number='12345 678912'}
    Access: Write-Host $PhoneBook.name

## Comparison operators (same as bash but without quotes):
Numeric:

    $a -lt $b
    $a -le $b
    $a -gt $b
    $a -eq $b
    $a -ne $b

## Control constructs
### if/if else
    if(condition){
    	# commands
    }
    elseif(condition2){
    	# commands2
    }
    else{
    	# All else has failed
    }

### for
    for($i=1;$i -lt 10; $i++){
    	Write-Host $i
    }
    Write-Host "Finished"

### while
    $a = 1
    while($a -lt 10){
    	Write-Host $a
    	$a++
    }
    Write-Host "Finished"

### do while (runs at least once)
    $i = 1
    do{
    	Write-Host $i
    	$i++
    }
    while($i -lt 10)
    Write-Host "Finished"

### until do
	$i = 1
    do{
    	Write-Host $i
    	$i++
    }
    until($i -gt 10)
    Write-Host "Finished"

### String operations

String manipulation:

    $testString = "Hello world!"
    Concatentation: Write-Host $testString + 2 - (outputs "testString2")
    Substring: Write-Host $testString.substring(2,4) - (outputs "st S")

Comparison operators:

    -eq - equals
    -ne
    -gt
    -ge
    -lt
    -le
    -like - wilcard pattern
    -notlike
    -match - regex pattern
    -notmatch
    -replace - replace strings matching wildcard pattern
    -contains - collection, contains a value
    -notcontains
    -in - value is in a collection
    -notin
    -is - both objects are of the same type
    -notis


### I/O
Console write/read:

    Write-Host "Please enter your name:"
    Read-Host $UserName
    Write-Host "Hello " + $UserName + "!" - (outputs "Hello user2!"

File I/O (can also redirect input/output using < or > for clobber, >> for append):

Read a file:

    $tempFile = Get-Content -Path C:\test.txt
    Write-Host $tempFile

Write to a file:

    Set-Content -Path C:\Test.txt -Value "Hello world!"

## [Miscellaneous - see also windows_commands.html](windows_commands.html#powershell)
