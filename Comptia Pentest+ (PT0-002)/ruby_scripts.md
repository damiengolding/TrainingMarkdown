# Ruby scripts

## Script structure
Header:

    #!/usr/bin/ruby
    #!/usr/bin/env ruby

Comment (no multi-line comment):

    # To end of line

## Variables
Declare:

    Global: $VariableName=VariableValue
    Local: _VariableName=VariableValue or lowercase
    Instance: @VariableName=VariableValue;
    Class: @@ariableName=VariableValue;
    Range: target_ports = 1..65535;
    $UserName=Gandalf;
    $UserName

Constants:

- No concept of constants
- Use all upper case to signify constant

Arrays:
	
    Initialise empty: tempArray = Array.new
    Initialise with size: tempArray = Array.new(20)
    Initialise with contents: tempArray = [value1,value2,value3] 
    Access: tempArray.at(n)

Named/associative arrays:

    Blank array: PhoneBook = {}
    Initialise with contents: PhoneBook = [["Frodo","01234 567890"],["Gandalf","98765 432109"]]
    Initialise with contents: PhoneBook = {"Frodo" => "01234 567890", "Gandalf" => "98765 432109" }
    Access: PhoneBook["Gandalf"] - outputs "98765 432109"
    Access: PhoneBook.assoc("Gandalf") - outputs ["Gandalf","98765 432109"]

## Comparison operators
Numeric and string comparisons (similar to C or C++):

    Is equal: a == b
    Is not equal: a != b OR a <> b
    etc

## Control constructs (Ruby has no pre/post increment/decrement operator)
### if/if else
    if a < b
    	puts a
    elsif a > b
    	puts b
    else
    	puts "a equals b"
    end

### for
    for x in {1..5}
    	puts x
    end

### do
    target_ports = 1..65535;
    target_ports.each do |port|
    	banner = TCPSocket.new("192.168.4.42", port).recv(1024);
		puts "Testing 192.168.4.42 on port #{port}"
    end

### while
    a = 1
    while a > 10
    	puts a
    	a += 1
    end
    
    puts "Finished"

### until
    a = 1
    until a > 10
    	puts a
    	a += 1
    end
    
    puts "Finished"

### String operations
String manipulation:

    testString = "Test String"
    Substring: puts testString[2..5] - (outputs "st S")

### Functions
Declare:
    
    def my_function(arg1)
    	return arg1 % 2
    end

Call:

	myRet = my_function(100)
	if myRet == 0
		puts "Is an even number"
	else
		puts "Is an odd number"
	end

### I/O
Console write/read:

    puts "Please enter your user name: "
    userName = gets
    puts "Hello " + userName

File I/O:

    Write:
	f = File.open("write.txt",'w')
	f.puts("Hello world")
	f.close

    Write:
	f = File.open("write.txt",'w')
	f << "Hello brave new world!" # << append < clobber
	f.close

    Read:
	f = File.open("test.txt") # no 'r', ruby assumes read
	while line = f.gets
		puts line
	end
	f.close

## Miscellaneous